{% load staticfiles %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Seedlot Selection Tool</title>

    <link rel="stylesheet" href="{% static "bootstrap/css/bootstrap.min.css" %}" />
    <link rel="stylesheet" href="{% static "bootstrap/css/bootstrap-theme.min.css" %}" />
    <link rel="stylesheet" href="{% static "leaflet/leaflet.css" %}" />
    <link rel="stylesheet" href="{% static "leaflet/controls/leaflet-basemaps/L.Control.Basemaps.css" %}" />
    <link rel="stylesheet" href="{% static "sst/css/tool.css" %}" />

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="{% static "react/react.min.js" %}"></script>
    <script src="{% static "react/react-dom.min.js" %}"></script>

    {% if debug %}
        <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>
    {% endif %}
</head>
<body>
    <!-- Navbar -->

    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="{% url "tool_page" %}">
                    <img src="{% static "sst/images/logo.png" %}" align="left" />
                    <span style="color: #FFF">Seedlot</span> Selection Tool
                </a>
            </div>
            <div>
                <ul id="SignedInNav" class="nav navbar-nav navbar-right hidden">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                            <span id="EmailDisplay"></span>
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="#" data-toggle="modal" data-target="#SettingsModal">Account Settings</a></li>
                            <li><a href="javascript:logout()">Sign Out</a></li>
                        </ul>
                    </li>
                </ul>
                <ul id="SignedOutNav" class="nav navbar-nav navbar-right hidden">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                            Account
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="#" data-toggle="modal" data-target="#RegisterModal">Create Account</a></li>
                            <li><a href="#" data-toggle="modal" data-target="#LoginModal">Sign In</a></li>
                        </ul>
                    </li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#InfoModal" data-title="Purpose" data-content="#PurposeContent">
                            Purpose
                        </a>
                    </li>
                    <li>
                        <a href="#" data-toggle="modal" data-target="#InfoModal" data-title="Get Started" data-content="#GetStartedContent">
                            Get Started
                        </a>
                    </li>
                    <li>
                        <a href="#" data-toggle="modal" data-target="#InfoModal" data-title="People" data-content="#PeopleContent">People</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                            Details
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="#" data-toggle="modal" data-target="#InfoModal" data-title="Instructions" data-content="#InstructionsContent">
                                    Instructions
                                </a>
                            </li>
                            <li>
                                <a href="#" data-toggle="modal" data-target="#InfoModal" data-title="Approach" data-content="#ApproachContent">
                                    Approach
                                </a>
                            </li>
                            <li>
                                <a href="#" data-toggle="modal" data-target="#InfoModal" data-title="ClimateNA" data-content="#ClimateNAContent">
                                    ClimateNA
                                </a>
                            </li>
                            <li>
                                <a href="#" data-toggle="modal" data-target="#InfoModal" data-title="Forest genetics and climate change" data-content="#ForestGeneticsContent">
                                    Forest genetics and climate change
                                </a>
                            </li>
                            <li><a href="https://github.com/consbio/seedsource" target="_blank">Source Code</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main body -->

    <div class="container-fluid">
        <div class="row">
            <div class="sidebar">
                <div id="JobStatusOverlay" class="overlay hidden">
                    <div class="progressContainer">
                        <h4>Calculating scores...</h4>
                        <div class="progress">
                            <div class="progress-bar progress-bar-info progress-bar-striped active" style="width: 100%"></div>
                        </div>
                    </div>
                </div>

                <ul class="nav nav-tabs" role="tablist">
                    <li role="presentation" class="active"><a href="#ToolTab" aria-controls="ToolTab" data-toggle="tab">Configuration</a></li>
                    <li role="presentation"><a href="#SavedTab" aria-controls="SavedTab" data-toggle="tab">Saved Runs</a></li>
                </ul>

                <div class="tab-content">
                    <div role="tabpanel" class="tab-pane active" id="ToolTab">
                        <div class="step">
                            <h4><span class="badge">1</span> Choose an objective</h4>
                            <div class="btn-group" data-toggle="buttons">
                                <label class="btn active">
                                    <input type="radio" name="objective" value="seedlots" checked />
                                    Find seedlots
                                </label>
                                <label class="btn">
                                    <input type="radio" name="objective" value="site" />
                                    Find planting sites
                                </label>
                            </div>
                        </div>
                        <div class="step">
                            <h4>
                                <span class="badge">2</span> <span id="SelectPointLabel">Select a planting site</span>
                            </h4>
                            <div class="coords">
                                <strong>Lat: </strong>
                                <input type="text" id="LatInput" class="form-control form-inline" />
                                <strong>Lon: </strong>
                                <input type="text" id="LonInput" class="form-control form-inline" />
                            </div>
                            <div>&nbsp;</div>
                            <div>
                                <label for="RegionSelect" class="control-label">Region</label>
                                <select id="RegionSelect" class="form-control">
                                    <option value="west1">West</option>
                                </select>
                            </div>
                        </div>
                        <div class="step">
                            <h4><span class="badge">3</span> Select planting site climate</h4>
                            <div>
                                <select id="TimeSelect" class="form-control form-inline">
                                    <option value="1961_1990">1961 - 1990</option>
                                    <option value="2025">2025</option>
                                    <option value="2055">2055</option>
                                    <option value="2085">2085</option>
                                </select>
                                <select id="RCPSelect" class="hidden form-control form-inline">
                                    <option value="rcp45">RCP 4.5</option>
                                    <option value="rcp85">RCP 8.5</option>
                                </select>
                            </div>
                        </div>
                        <div class="step">
                            <h4><span class="badge">4</span> Choose species</h4>
                            <select id="SpeciesSelect" class="form-control">
                                <option value="species_1" selected>Species 1</option>
                                <option value="species_2">Species 2</option>
                                <option value="species_3">Species 3</option>
                            </select>
                        </div>
                        <div class="step">
                            <h4><span class="badge">5</span> Choose variables & transfer limits</h4>
                            <div id="Variables"></div>
                        </div>
                        <div>
                            <h4></h4>
                            <button class="btn btn-lg btn-primary btn-block" id="RunButton" onClick="runJob()" disabled>Run Tool</button>
                        </div>
                        <div>
                            <h4></h4>
                            <div>
                                <button class="btn btn-default pull-left" id="SaveButton" onClick="handleSave()" disabled><span class="glyphicon glyphicon-save" aria-hidden="true"></span> Save Last Run</button>
                                <button class="btn btn-default pull-right" id="ExportButton" disabled><span class="glyphicon glyphicon-file" aria-hidden="true"></span> Export PDF</button>
                            </div>
                            <div style="clear: both;"></div>
                        </div>
                    </div>
                    <div role="tabpanel" class="tab-pane" id="SavedTab">
                        <div id="Configurations"></div>
                    </div>
                </div>
            </div>
            <div class="main">
                <div id="TimeOverlay" class="hidden"><span class="glyphicon glyphicon-time" aria-hidden="true"></span> Showing: <span id="TimeLabel">1961 - 1990</span></div>
                <div id="Map"></div>
            </div>
        </div>
    </div>

    <!-- Dialogs -->

    <div id="LoginModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Sign In</h4>
                </div>
                <div class="modal-body">
                    <div class="alert alert-danger hidden" role="alert">Invalid username or password.</div>
                    <form onsubmit="login(); return false;">
                        <input type="email" id="LoginEmail" class="form-control" placeholder="Email address" required autofocus />
                        <input type="password" id="LoginPassword" class="form-control" placeholder="Password" required />
                        <div>&nbsp;</div>
                        <button class="btn btn-lg btn-primary btn-block" type="submit">Sign In</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div id="RegisterModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Create Account</h4>
                </div>
                <div class="modal-body">
                    <div class="alert alert-danger hidden" role="alert"></div>
                    <form onsubmit="createAccount(); return false;">
                        <input type="email" id="RegisterEmail" class="form-control" placeholder="Email address" required autofocus />
                        <input type="password" id="RegisterPassword" class="form-control" placeholder="Password" required />
                        <input type="password" id="RegisterPasswordConfirm" class="form-control" placeholder="Confirm Password" required />
                        <div>&nbsp;</div>
                        <button class="btn btn-lg btn-primary btn-block" type="submit">Create Account</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div id="SettingsModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Account Settings</h4>
                </div>
                <div class="modal-body">
                    <form onsubmit="changeEmail(); return false;">
                        <label for="ChangeEmail" class="control-label">Email address</label>
                        <div class="alert alert-danger email hidden" role="alert"></div>
                        <input type="email" id="ChangeEmail" class="form-control" placeholder="New email" required />
                        <button class="btn btn-sm btn-primary" type="submit">Change Email</button>
                    </form>
                    <div>&nbsp;</div>
                    <form onsubmit="changePassword(); return false;">
                        <label for="ChangePassword" class="control-label">Password</label>
                        <div class="alert alert-danger password hidden" role="alert"></div>
                        <input type="password" id="ChangePassword" class="form-control" placeholder="New Password" required />
                        <input type="password" id="ChangePasswordConfirm" class="form-control" placeholder="Confirm Password" required />
                        <button class="btn btn-sm btn-primary" type="submit" >Change Password</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div id="SaveModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Save Run Configuration</h4>
                </div>
                <div class="modal-body">
                    <form onsubmit="saveConfiguration(); return false;">
                        <label for="RunTitle" class="control-label">Title</label>
                        <input type="text" id="RunTitle" class="form-control" required />
                        <div>&nbsp;</div>
                        <button class="btn btn-lg btn-primary btn-block" type="submit">Save</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div id="OverwriteModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Save Run Configuration</h4>
                </div>
                <div class="modal-body">
                    <div>Do you want to update the current configuration, <strong><span id="CurrentSaveTitle"></span></strong>, or save as a new configuration?</div>
                    <div>&nbsp;</div>
                    <div>
                        <button class="btn btn-default pull-left" onClick="showSaveDialog()">Save as new</button>
                        <button class="btn btn-primary pull-right" onClick="updateConfiguration()">Update current</button>
                    </div>
                    <div style="clear: both;"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="InfoModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title"></h4>
                </div>
                <div class="modal-body" id="PurposeContent">
                    <p>
                        The seedlot selection tool (SST) is a GIS mapping program designed to help forest managers
                        match seedlots with planting sites based on climatic information. The tool can be used to map
                        current climates, or future climates based on selected climate change scenarios. Although it
                        is tailored for matching seedlots and planting sites, it can be used by anyone interested in
                        mapping present or future climates defined by temperature and precipitation.
                    </p>
                    <p>
                        Forest managers can use this tool to help choose seedlots that are appropriate for planting on
                        a particular site, or planting sites that are appropriate for a particular seedlot. This can
                        be done using current climate models (i.e., ignoring potential climate change) or by choosing
                        a climate change model, emissions scenario, and future target year. Because of the uncertainty
                        in climate change projections, the tool is really a planning and educational tool. It can be
                        used to explore alternative future conditions, assess risk, and plan potential responses, but
                        cannot tell the user exactly which seedlots will be optimally adapted to a particular planting
                        site in the future. The tool allows the user to control many input parameters so the results
                        are appropriate for the management practices, climate change assumptions, and risk tolerance of
                        the user.
                    </p>
                </div>
                <div class="modal-body" id="GetStartedContent">
                    Todo... <em>Just enough information needed to get started…and some tips.</em>
                </div>
                <div class="modal-body" id="PeopleContent">
                    Todo... <em>People and their contact information, including sources of funding.</em>
                </div>
                <div class="modal-body" id="InstructionsContent">
                    Todo... <em>Detailed instructions and a link to the instruction manual (PDF).</em>
                </div>
                <div class="modal-body" id="ApproachContent">
                    Todo... <em>Detailed information on the methods used and caveats.</em>
                </div>
                <div class="modal-body" id="ClimateNAContent">
                    Todo... <em>Overview of ClimateNA data (present and future) and links to relevant papers.</em>
                </div>
                <div class="modal-body" id="ForestGeneticsContent">
                    Todo... <em>Overview of genetic variation in forest trees, potential effects of climate change, and links to key papers.</em>
                </div>
            </div>
        </div>
    </div>

    <script src="{% static "jquery/jquery-2.1.4.min.js" %}"></script>
    <script src="{% static "jquery/jquery.cookie-1.4.1.min.js" %}"></script>
    <script src="{% static "bootstrap/js/bootstrap.min.js" %}"></script>
    <script src="{% static "leaflet/leaflet.js" %}"></script>
    <script src="{% static "leaflet/controls/leaflet-basemaps/L.Control.Basemaps-min.js" %}"></script>

    {% if debug %}
        <script src="{% static "sst/js/leaflet-controls.js" %}"></script>
        <script src="{% static "sst/js/tool.js" %}"></script>
        <script src="{% static "sst/js/components.jsx" %}" type="text/babel"></script>
    {% else %}
        <script src="{% static "sst/js/leaflet-controls.min.js" %}"></script>
        <script src="{% static "sst/js/tool.min.js" %}"></script>
        <script src="{% static "sst/js/components.min.js" %}"></script>
    {% endif %}
</body>
</html>
